---
name: presentation-research
description: "WEB調査に基づいてプレゼンテーション資料(.pptx)を作成する。テーマが与えられたらWEB検索を実行し、複数の視点とソースから実務的・実用的な情報を収集し、ビジネス向けプロフェッショナルなデザインのPowerPoint資料を生成する。調査プロセスと結果を詳細なログとともに表示し、ユーザーが指定した言語で資料を作成する。タイトル、目次、要約、詳細分析、結論・提言、参考文献のスライドを含む包括的な資料を提供する。"
---

# Presentation Research Skill

WEB調査を行い、その結果をもとにプロフェッショナルなプレゼンテーション資料を作成するスキルです。

## 概要

このスキルは以下のワークフローで動作します:

1. **テーマの理解と調査計画の立案**
2. **WEB調査の実行**
3. **情報の整理と分析**
4. **プレゼンテーション資料の設計**
5. **PowerPoint資料の作成**
6. **品質チェックと最終化**

## 使用タイミング

以下のような場合にこのスキルを使用します:

- ユーザーが特定のテーマについてプレゼンテーション資料の作成を依頼した場合
- 「〜についてのプレゼン資料を作って」「〜についてのスライドを作成して」などの依頼
- 調査とプレゼンテーション作成を同時に依頼された場合
- 特定のトピックについて包括的な資料が必要な場合

## ワークフロー詳細

### 1. テーマの理解と調査計画

ユーザーから提供されたテーマを分析し、以下を決定します:

- 調査すべき主要なトピック・サブトピック
- 必要な情報の種類(統計データ、事例、トレンド、専門家の意見など)
- 適切な調査の深さ(基本的な情報収集 3-5ソース、中程度の調査 5-10ソース、深い調査 10+ソース)
- 想定されるスライド構成

**調査計画の作成:**
```
テーマ: [ユーザーが指定したテーマ]

調査目標:
- [主要な調査目標1]
- [主要な調査目標2]
- [主要な調査目標3]

調査項目:
1. [調査項目1] - 期待される情報: [説明]
2. [調査項目2] - 期待される情報: [説明]
3. [調査項目3] - 期待される情報: [説明]

予定スライド構成:
1. タイトルスライド
2. 目次
3-N. コンテンツスライド
N+1. 結論・提言
N+2. 参考文献
```

### 2. WEB調査の実行

**重要: 調査プロセスは常に詳細に記録し、ユーザーに表示します。**

調査の原則:
- **複数の視点**: 異なる情報源から情報を収集し、バイアスを避ける
- **実務的・実用的**: 理論だけでなく実践的な情報を優先
- **最新性**: 可能な限り最新の情報を収集
- **信頼性**: 公式サイト、専門機関、信頼できるメディアを優先

調査の実行:
```python
# テーマに応じて3-15回程度のweb_search呼び出しを行う
# 各検索の目的と結果を明確に記録する

検索1: [検索クエリ]
目的: [なぜこの検索を行うか]
結果: [見つかった主要な情報]
ソース: [URL]

検索2: [検索クエリ]
目的: [なぜこの検索を行うか]
結果: [見つかった主要な情報]
ソース: [URL]

...
```

**調査ログの形式:**
```
=== WEB調査プロセス ===

【調査計画】
テーマ: [テーマ]
調査の深さ: [基本/中程度/深い]
目標: [調査の目標]

【調査実行】

[検索1]
クエリ: "[検索キーワード]"
目的: [この検索で何を明らかにしたいか]
主要な発見:
- [発見事項1]
- [発見事項2]
参照ソース: [URL1], [URL2]

[検索2]
クエリ: "[検索キーワード]"
目的: [この検索で何を明らかにしたいか]
主要な発見:
- [発見事項1]
- [発見事項2]
参照ソース: [URL1], [URL2]

...

【調査結果サマリー】
- 主要な発見事項
- 注目すべきトレンド
- 異なる視点や意見
- データと統計
- 実用的なインサイト

【参考文献リスト】
1. [タイトル] - [URL]
2. [タイトル] - [URL]
...
```

### 3. 情報の整理と分析

収集した情報を以下の観点で整理:

- **主要なテーマ**: 調査で明らかになった中心的なトピック
- **サブトピック**: 主要テーマを構成する個別の要素
- **データポイント**: 統計、数値、具体的な事実
- **事例・ケーススタディ**: 実例や具体例
- **トレンド**: 時系列的な変化や今後の方向性
- **異なる視点**: 複数の立場や意見
- **実用的なインサイト**: アクションにつながる知見

### 4. プレゼンテーション資料の設計

**スライド構成の決定:**

必須要素:
1. **タイトルスライド**: テーマ、サブタイトル、日付
2. **目次スライド**: プレゼンテーションの構成を明示
3. **調査結果の要約スライド**: エグゼクティブサマリー、主要な発見事項
4. **詳細な分析スライド**: 各サブトピックの深堀り
5. **結論・提言スライド**: インサイトと推奨アクション
6. **参考文献・出典スライド**: 調査で使用したソースのリスト

**デザイン原則:**

ビジネス向けプロフェッショナルなデザイン:
- 明確で読みやすいレイアウト
- 一貫した色使いとフォント
- 適切な余白とスペーシング
- プロフェッショナルな配色(青系、グレー系など)

バランスの取れた内容構成:
- テキストと視覚要素のバランス
- 適度にグラフや図表を使用
- 箇条書きと段落のバランス
- スライドごとの情報量の調整

視覚要素の活用:
- データはグラフや図表で視覚化
- 重要な数値は大きく強調
- プロセスはフロー図で表現
- 比較は表や並列レイアウトで表現

**スライド設計の例:**

```
スライド1: タイトル
- テーマタイトル(大きく、中央揃え)
- サブタイトル(必要に応じて)
- 日付
- シンプルな背景デザイン

スライド2: 目次
- セクションのリスト
- ページ番号(オプション)
- シンプルなアイコンやナンバリング

スライド3: エグゼクティブサマリー
- 3-5個の主要な発見事項
- 箇条書きまたはカード形式
- 重要な統計を強調

スライド4-N: 詳細分析
- 各サブトピックごとに1-3スライド
- データの視覚化(グラフ、表)
- 具体例や事例
- 重要なポイントの強調

スライドN+1: 結論・提言
- 主要なインサイト
- 推奨アクション
- 今後の展望

スライドN+2: 参考文献
- 使用したソースのリスト
- URL付き(可能な場合)
```

### 5. PowerPoint資料の作成

**重要: pptxスキルを活用します**

作成開始前に必ず `/mnt/skills/public/pptx/SKILL.md` を読み、ベストプラクティスに従います。

**技術選択:**

pptxgenjsを使用して新規作成:
```javascript
const pptx = new pptxgen();

// スライドマスターの設定
pptx.defineLayout({ name: 'CUSTOM', width: 10, height: 5.625 });
pptx.layout = 'CUSTOM';

// カラーパレットの定義(ビジネス向け)
const colors = {
  primary: '1E2761',    // ネイビー
  secondary: 'CADCFC',  // アイスブルー
  accent: '4A90E2',     // ブライトブルー
  text: '333333',       // ダークグレー
  textLight: '666666',  // ミディアムグレー
  background: 'FFFFFF'  // ホワイト
};

// フォント設定
const fonts = {
  title: { face: 'Calibri', size: 40, bold: true },
  heading: { face: 'Calibri', size: 24, bold: true },
  body: { face: 'Calibri', size: 16 },
  caption: { face: 'Calibri', size: 12 }
};
```

**スライド作成のベストプラクティス:**

1. **一貫性**: すべてのスライドで同じデザイン要素を使用
2. **余白**: 適切なマージン(0.5インチ以上)を確保
3. **フォントサイズ**: タイトル36-44pt、本文14-16pt
4. **色のコントラスト**: テキストと背景のコントラストを確保
5. **視覚要素**: 各スライドに少なくとも1つの視覚要素
6. **シンプルさ**: 1スライド1メッセージの原則

**データ視覚化:**

```javascript
// グラフの例
slide.addChart(pptx.ChartType.bar, dataChartAreaLine, {
  x: 1.0,
  y: 1.5,
  w: 8.0,
  h: 3.5,
  showTitle: true,
  title: 'タイトル',
  showLegend: true,
  legendPos: 'r'
});
```

### 6. 品質チェックと最終化

**必須QAプロセス:**

1. **コンテンツQA**:
```bash
python -m markitdown output.pptx
```
- すべての情報が正しく含まれているか
- 誤字脱字がないか
- 参考文献が完全か

2. **ビジュアルQA**:
```bash
python scripts/office/soffice.py --headless --convert-to pdf output.pptx
pdftoppm -jpeg -r 150 output.pdf slide
```

サブエージェントを使用してビジュアル検証:
- 要素の重なりはないか
- テキストの切れはないか
- レイアウトの崩れはないか
- 色のコントラストは十分か
- スペーシングは適切か

3. **修正とレビュー**:
- 問題が見つかった場合は修正
- 再度QAを実施
- すべての問題が解決されるまで繰り返す

## 言語対応

ユーザーが指定した言語でプレゼンテーション資料を作成します:

- 日本語での依頼 → 日本語のスライド
- 英語での依頼 → 英語のスライド
- 特定言語の指定 → 指定された言語のスライド

**注意**: WEB調査は必要に応じて複数の言語で実施し、スライドは指定言語で作成します。

## テーマに応じた柔軟な対応

**スライド数の調整:**
- シンプルなテーマ: 5-10スライド
- 中程度の複雑さ: 10-20スライド
- 複雑なテーマ: 20スライド以上

**調査の深さの調整:**
- 基本的な概要: 3-5個のソース
- 標準的な調査: 5-10個のソース
- 深い分析: 10個以上のソース

テーマの複雑さ、求められる詳細度、時間的制約などを考慮して、最適なアプローチを選択します。

## 出力形式

最終的な成果物:

1. **プレゼンテーション資料(.pptx)**: `/mnt/user-data/outputs/`に配置
2. **調査レポート(任意)**: 調査プロセスと主要な発見事項をまとめたマークダウンファイル
3. **参考文献リスト**: スライド内および独立したドキュメント

## エラーハンドリング

- WEB検索が失敗した場合: 別のキーワードで再試行
- 情報が不足している場合: 追加の調査を実施
- PowerPoint作成でエラーが発生した場合: デバッグとリトライ
- QAで問題が見つかった場合: 修正して再QA

## ベストプラクティス

1. **調査の透明性**: すべての調査ステップをユーザーに見せる
2. **情報の質**: 信頼できるソースを優先
3. **バランス**: 複数の視点を含める
4. **実用性**: 理論だけでなく実践的な情報を含める
5. **視覚的魅力**: プロフェッショナルで見やすいデザイン
6. **一貫性**: デザインとメッセージの一貫性を保つ
7. **品質保証**: 必ずQAプロセスを実施

## 依存関係

- `web_search` tool: WEB調査用
- `web_fetch` tool: 詳細情報の取得用
- `/mnt/skills/public/pptx/`: PowerPoint作成用
- `python-pptx` または `pptxgenjs`: スライド生成
- `markitdown`: コンテンツQA用
- LibreOffice: ビジュアルQA用

## 使用例

**例1: 基本的な使用**
```
ユーザー: AIの最新トレンドについてプレゼン資料を作って

スキルの動作:
1. テーマ分析: AIの最新トレンド(2025年)
2. 調査計画: 5-7個の検索を計画
3. WEB調査: 最新のAIニュース、技術動向、市場予測を調査
4. 情報整理: 主要トレンド、技術的進歩、ビジネス応用を整理
5. スライド設計: 10-15スライドを計画
6. PowerPoint作成: pptxgenjsで作成
7. QA: コンテンツとビジュアルのチェック
8. 提供: output.pptxをユーザーに提示
```

**例2: 深い調査が必要な場合**
```
ユーザー: 日本の少子高齢化問題と対策について詳細なプレゼン資料を作成してください

スキルの動作:
1. テーマ分析: 複雑な社会問題、多角的な視点が必要
2. 調査計画: 10-15個の検索を計画
3. WEB調査: 統計データ、政府の政策、専門家の意見、国際比較、成功事例
4. 情報整理: 現状、原因、影響、対策、事例を体系化
5. スライド設計: 20-25スライドを計画
6. PowerPoint作成: データグラフ、比較表、フロー図を含む
7. QA: 徹底的なチェック
8. 提供: 包括的なプレゼンテーション資料
```

## まとめ

このスキルは、WEB調査からプレゼンテーション資料作成までを一貫して実行します。調査プロセスの透明性、情報の質とバランス、プロフェッショナルなデザイン、徹底的な品質保証により、ユーザーに価値ある資料を提供します。
